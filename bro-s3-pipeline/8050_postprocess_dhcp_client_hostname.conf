# Original Author: Alex Bortok
# Last Update: 6/03/2019

filter {
  if [type] == "bro_conn" {
    elasticsearch {
      hosts => ["${LS_PIPELINE_BRO_ELASTIC_HOST}"]
      user => "${LS_PIPELINE_BRO_ELASTIC_USER}"
      password => "${LS_PIPELINE_BRO_ELASTIC_PASSWORD}"
      index => "logstash-ecs-*"
      query => "ecs.version:* AND event.dataset:bro.dhcp AND zeek.dhcp.ip_assigned:\"%{[source_ip]}\""
      fields => { "host.hostname" => "host.hostname" }
    }

  	mutate {
  	  add_tag => [ "conf_file_8050"]
  	}
  }
}
