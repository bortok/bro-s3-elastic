# Original Author: Alex Bortok
# Last Update: 6/03/2019

filter {
  if [type] == "bro_conn" {
    elasticsearch {
      hosts => ["${LS_PIPELINE_BRO_ELASTIC_HOST}"]
      user => "${LS_PIPELINE_BRO_ELASTIC_USER}"
      password => "${LS_PIPELINE_BRO_ELASTIC_PASSWORD}"
      query_template => "8050_postprocess_dhcp_client_hostname.json"
      fields => { "host.hostname" => "client.hostname" }
    }

	mutate {
	  add_tag => [ "conf_file_8050"]
	}
  }
}
